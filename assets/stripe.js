!function(){var e="https://js.stripe.com/v3",t=/^https:\/\/js\.stripe\.com\/v3\/?(\?.*)?$/,n="loadStripe.setLoadParameters was called but an existing Stripe.js script already exists in the document; existing script parameters will be used",o=null,r=function(r){return null!==o||(o=new Promise((function(o,a){if("undefined"!=typeof window)if(window.Stripe&&r&&console.warn(n),window.Stripe)o(window.Stripe);else try{var s=function(){for(var n=document.querySelectorAll('script[src^="'.concat(e,'"]')),o=0;o<n.length;o++){var r=n[o];if(t.test(r.src))return r}return null}();s&&r?console.warn(n):s||(s=function(t){var n=t&&!t.advancedFraudSignals?"?advancedFraudSignals=false":"",o=document.createElement("script");o.src="".concat(e).concat(n);var r=document.head||document.body;if(!r)throw new Error("Expected document.body not to be null. Stripe.js requires a <body> element.");return r.appendChild(o),o}(r)),s.addEventListener("load",(function(){window.Stripe?o(window.Stripe):a(new Error("Stripe.js not available"))})),s.addEventListener("error",(function(){a(new Error("Failed to load Stripe.js"))}))}catch(e){return void a(e)}else o(null)}))),o},a=function(e,t,n){if(null===e)return null;var o=e.apply(void 0,t);return function(e,t){e&&e._registerWrapper&&e._registerWrapper({name:"stripe-js",version:"1.35.0",startTime:t})}(o,n),o},s=Promise.resolve().then((function(){return r(null)})),i=!1;s.catch((function(e){i||console.warn(e)}));var l=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];i=!0;var o=Date.now();return s.then((function(e){return a(e,t,o)}))};async function c(e,t,n){let o={method:e,mode:"cors",cache:"no-cache",credentials:"same-origin",headers:{Accept:"application/json","Content-Type":"application/json; charset=utf-8"},redirect:"follow",referrer:"no-referrer"};void 0!==n&&Object.assign(o,{body:JSON.stringify(n)});const r=await fetch(t,o),a=await r.json();if(!0!==r.ok)throw new Error(a.detail);return a}async function d(e){const t={locale:e.lang,successUrl:`${e.url}/${e.lang}/support.html#success`,cancelUrl:`${e.url}/${e.lang}/support.html#cancel`,plan:e.plan};return await c("POST","https://stripe.osm.be/checkout/session/plan",t)}async function u(e){const t={locale:e.lang,successUrl:`${e.url}/${e.lang}/support.html#success`,cancelUrl:`${e.url}/${e.lang}/support.html#cancel`,amount:100*e.amount,currency:"eur"};return null!==e.message&&e.message.length>0&&(t.message=e.message),await c("POST","https://stripe.osm.be/checkout/session/donation",t)}async function m(e){if(void 0===e||"object"!=typeof e)return;const t=await l("pk_live_mFpKP0JmQWp9mQ2FjetxyzlH",{stripeAccount:"acct_1DDvHwEKdKUBXjXu"});document.querySelectorAll("#donation-result > div").forEach((e=>e.style.display="none")),document.querySelector(".overlay").style.display="";try{let n;if(e.hasOwnProperty("plan")&&void 0!==e.plan?n=await d(e):e.hasOwnProperty("amount")&&void 0!==e.amount&&(n=await u(e)),void 0===n)throw"Unable to initialize Stripe session";if(n.hasOwnProperty("error"))throw n.error;t.redirectToCheckout({sessionId:n.id}).then((e=>{if(e.error)throw e.error.message}))}catch(e){document.querySelector(".overlay").style.display="none",document.getElementById("error-message").innerText=e,document.getElementById("donation-result-error").style.display="",document.getElementById("donation-result-error").scrollIntoView()}}"#success"===window.location.hash?(document.getElementById("donation-result-success").style.display="",document.getElementById("donation-result-success").scrollIntoView()):"#cancel"===window.location.hash&&(document.getElementById("donation-result-cancel").style.display="",document.getElementById("donation-result-cancel").scrollIntoView()),document.querySelectorAll(".donation-btn[data-plan-id]").forEach((e=>{e.addEventListener("click",(async e=>{const t=e.target.dataset.planId;await m({plan:t,lang:window.app.lang||"en",url:window.app.url||"https://openstreetmap.be"})}))})),document.querySelectorAll(".donation-btn[data-amount]").forEach((e=>{e.addEventListener("click",(e=>{const t=parseInt(e.target.dataset.amount);document.getElementById("donation-amount").value=t.toString(),t>0?document.getElementById("donation-submit").removeAttribute("disabled"):document.getElementById("donation-submit").setAttribute("disabled","")}))})),["change","blur","keyup"].forEach((e=>{document.getElementById("donation-amount").addEventListener(e,(e=>{parseInt(e.target.value)>0?document.getElementById("donation-submit").removeAttribute("disabled"):document.getElementById("donation-submit").setAttribute("disabled","")}))})),document.getElementById("donation-submit").addEventListener("click",(async e=>{const t=parseInt(document.getElementById("donation-amount").value),n=document.getElementById("donation-message").value;e.preventDefault(),await m({amount:t,message:n,lang:window.app.lang||"en",url:window.app.url||"https://openstreetmap.be"})}))}();